<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>GORM 数据库操作 | LeoBlog</title><meta name="keywords" content="Backend,GORM,项目,数据库"><meta name="author" content="King Leonardo"><meta name="copyright" content="King Leonardo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="GORM 数据库操作"><meta name="application-name" content="GORM 数据库操作"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="GORM 数据库操作"><meta property="og:url" content="http://example.com/2025/06/03/backend-gorm/index.html"><meta property="og:site_name" content="LeoBlog"><meta property="og:description" content="这是一篇初学Go的文章，包含项目构建及项目工程化基本流程"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://imgs.161517.xyz/2025/05/10/1009.jpg"><meta property="article:author" content="King Leonardo"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://imgs.161517.xyz/2025/05/10/1009.jpg"><meta name="description" content="这是一篇初学Go的文章，包含项目构建及项目工程化基本流程"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/06/03/backend-gorm/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;63ee268ee87a46d98e0eeaab5bdafc9a&quot;}"></script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w","backTitle":"♪(^∇^*)"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: King Leonardo","link":"链接: ","source":"来源: LeoBlog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'LeoBlog',
  title: 'GORM 数据库操作',
  postAI: '',
  pageFillDescription: 'GORM 数据库操作速查手册, 准备工作, 数据库连接与模型定义, 1. 插入数据 (Create), 1.1 插入单条记录, 1.2 批量插入记录, 2. 查询数据 (Retrieve), 2.1 根据主键查询 (First x2F Find), 2.2 根据条件查询 (Where), 2.3 查询所有记录 (Find), 2.4 排序、限制和偏移 (Order Limit Offset), 3. 更新数据 (Update), 3.1 更新单个字段 (Update), 3.2 更新多个字段 (Updates), 3.3 计数器更新 (Inc x2F Dec), 4. 删除数据 (Delete), 4.1 软删除 (Soft Delete), 4.2 硬删除 (Permanent Delete), 总结数据库操作速查手册是语言中一个功能强大的库它提供了简洁的来操作数据库支持多种数据库如等本文档将介绍的常用操作插入查询更新和删除并演示如何将查询结果赋值给语言的变量准备工作在开始之前确保你已经安装了和相应的数据库驱动示例中使用你可以替换为其他数据库驱动数据库连接与模型定义首先我们需要建立数据库连接和定义一个数据模型示例使用是一个模型映射到数据库中的表包含了常用的字段是自增主键姓名非空邮箱唯一且非空年龄余额默认值为还可以添加其他字段例如全局实例实际项目中通常通过依赖注入管理连接到数据库自动迁移模式根据结构体创建或更新数据库表这里可以调用各种操作函数进行演示开始操作演示插入操作插入查询操作查询第一页每页条更新操作更新删除操作删除软删除硬删除如果需要再次查询所有用户看软删除效果再次查询所有用户插入数据使用方法将新的记录插入到数据库中插入单条记录插入单条用户记录传入结构体指针会将新记录的填充回结构体使用示例此时会被填充为新插入记录的自增批量插入记录传递一个结构体切片给即可实现批量插入批量插入用户记录传入结构体切片指针使用示例查询数据提供了多种查询方法可以灵活地检索数据查询结果会赋值给语言的变量根据主键查询查找主键匹配的第一个记录如果没有找到记录会是查找主键匹配的所有记录如果找到多个只会赋值给切片根据查询用户会根据主键查找如果找不到会返回传入结构体指针和主键值使用示例根据条件查询使用方法添加查询条件根据邮箱查询用户方法用于构建查询条件使用占位符防止注入根据姓名模糊查询所有匹配的用户声明一个结构体切片来存储多条记录使用进行模糊匹配复杂条件查询链式调用多个条件使用示例查找名字中包含的用户查询所有记录不带条件的方法会查询表中的所有记录查询所有用户声明一个结构体切片使用示例排序限制和偏移用于分页和排序查询结果分页查询用户计算偏移量使用示例查询第一页每页条更新数据提供了多种更新数据的方法更新单个字段方法用于更新模型的单个字段根据更新用户姓名和邮箱首先找到记录更新单个字段更新单个字段更新多个字段使用或结构体使用结构体更新或者使用更新使用示例更新多个字段方法用于更新模型的多个字段根据邮箱更新用户年龄和余额使用找到记录然后用更新使用示例计数器更新用于原子性地增加或减少字段值增加用户年龄或者使用方法删除数据支持软删除和硬删除软删除如果你的模型嵌入了或包含字段默认会进行软删除它不会真正删除记录而是将字段设置为当前时间软删除的记录在常规查询中不会被检索到除非使用方法软删除用户使用方法进行软删除传入结构体指针和主键值查找被软删除的用户需要使用方法可以查询被软删除的记录使用示例软删除为的用户此时应该找不到为的用户可以找到被软删除的用户硬删除如果你想彻底从数据库中删除记录可以使用硬删除用户使用进行硬删除使用示例硬删除为的用户总结本文档涵盖了中最常用的数据库操作方法还有许多高级功能例如关联一对一一对多多对多关系事务确保一系列数据库操作的原子性预加载一次性加载关联数据以避免查询问题钩子在创建更新删除等操作前后执行自定义逻辑原生当无法满足需求时直接执行语句查阅官方文档以获取更多详细信息和高级用法',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-03 10:46:11',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">LeoBlog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://imgs.161517.xyz/2025/06/02/wechat-pay-qr.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://imgs.161517.xyz/2025/06/02/wechat-pay-qr.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://imgs.161517.xyz/2025/06/02/alipay-qr.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://imgs.161517.xyz/2025/06/02/alipay-qr.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Backend/" style="font-size: 1.05rem;">Backend<sup>5</sup></a><a href="/tags/GORM/" style="font-size: 1.05rem;">GORM<sup>1</sup></a><a href="/tags/Gin/" style="font-size: 1.05rem;">Gin<sup>1</sup></a><a href="/tags/Go/" style="font-size: 1.05rem;">Go<sup>4</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 1.05rem;">Redis<sup>1</sup></a><a href="/tags/Viper/" style="font-size: 1.05rem;">Viper<sup>1</sup></a><a href="/tags/Web-Framework/" style="font-size: 1.05rem;">Web Framework<sup>1</sup></a><a href="/tags/frontend/" style="font-size: 1.05rem;">frontend<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 1.05rem;">博客搭建<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">数据库<sup>2</sup></a><a href="/tags/%E7%BC%93%E5%AD%98/" style="font-size: 1.05rem;">缓存<sup>1</sup></a><a href="/tags/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96/" style="font-size: 1.05rem;">配置读取<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 1.05rem;">项目<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">学习笔记</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%90%8E%E7%AB%AF/" itemprop="url">后端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Backend/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Backend</span></a><a class="article-meta__tags" href="/tags/GORM/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>GORM</span></a><a class="article-meta__tags" href="/tags/%E9%A1%B9%E7%9B%AE/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>项目</span></a><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>数据库</span></a></span></div></div><h1 class="post-title" itemprop="name headline">GORM 数据库操作</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-06-03T02:26:36.843Z" title="发表于 2025-06-03 10:26:36">2025-06-03</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-06-03T02:46:11.161Z" title="更新于 2025-06-03 10:46:11">2025-06-03</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">3.1k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="GORM 数据库操作"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为成都"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>成都</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://imgs.161517.xyz/2025/05/10/1009.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/06/03/backend-gorm/"><header><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">学习笔记</a><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%90%8E%E7%AB%AF/" itemprop="url">后端</a><a href="/tags/Backend/" tabindex="-1" itemprop="url">Backend</a><a href="/tags/GORM/" tabindex="-1" itemprop="url">GORM</a><a href="/tags/%E9%A1%B9%E7%9B%AE/" tabindex="-1" itemprop="url">项目</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" tabindex="-1" itemprop="url">数据库</a><h1 id="CrawlerTitle" itemprop="name headline">GORM 数据库操作</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">King Leonardo</span><time itemprop="dateCreated datePublished" datetime="2025-06-03T02:26:36.843Z" title="发表于 2025-06-03 10:26:36">2025-06-03</time><time itemprop="dateCreated datePublished" datetime="2025-06-03T02:46:11.161Z" title="更新于 2025-06-03 10:46:11">2025-06-03</time></header><h1 id="GORM-数据库操作速查手册"><a href="#GORM-数据库操作速查手册" class="headerlink" title="GORM 数据库操作速查手册"></a>GORM 数据库操作速查手册</h1><p>GORM 是 Go 语言中一个功能强大的 ORM (Object-Relational Mapping) 库。它提供了简洁的 API 来操作数据库，支持多种数据库（如 MySQL, PostgreSQL, SQLite, SQL Server 等）。</p>
<p>本文档将介绍 GORM 的常用操作：插入 (Create)、查询 (Retrieve)、更新 (Update) 和删除 (Delete)，并演示如何将查询结果赋值给 Go 语言的变量。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>在开始之前，确保你已经安装了 GORM 和相应的数据库驱动。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go get -u gorm.io/gorm</span><br><span class="line">go get -u gorm.io/driver/sqlite <span class="comment"># 示例中使用 SQLite，你可以替换为其他数据库驱动</span></span><br></pre></td></tr></table></figure>

<h3 id="数据库连接与模型定义"><a href="#数据库连接与模型定义" class="headerlink" title="数据库连接与模型定义"></a>数据库连接与模型定义</h3><p>首先，我们需要建立数据库连接和定义一个数据模型。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/driver/sqlite&quot;</span> <span class="comment">// 示例使用 SQLite</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// User 是一个 GORM 模型，映射到数据库中的 `users` 表</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// gorm.Model 包含了常用的字段: ID, CreatedAt, UpdatedAt, DeletedAt</span></span><br><span class="line">	<span class="comment">// ID 是自增主键</span></span><br><span class="line">	gorm.Model</span><br><span class="line">	Name    <span class="type">string</span> <span class="string">`gorm:&quot;size:255;not null&quot;`</span> <span class="comment">// 姓名，非空</span></span><br><span class="line">	Email   <span class="type">string</span> <span class="string">`gorm:&quot;unique;not null&quot;`</span>   <span class="comment">// 邮箱，唯一且非空</span></span><br><span class="line">	Age     <span class="type">uint</span>   <span class="comment">// 年龄</span></span><br><span class="line">	Balance <span class="type">float64</span> <span class="string">`gorm:&quot;default:0.0&quot;`</span> <span class="comment">// 余额，默认值为 0.0</span></span><br><span class="line">	<span class="comment">// 还可以添加其他字段，例如：</span></span><br><span class="line">	<span class="comment">// IsActive bool</span></span><br><span class="line">	<span class="comment">// Address string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Global DB instance (全局 DB 实例，实际项目中通常通过依赖注入管理)</span></span><br><span class="line"><span class="keyword">var</span> DB *gorm.DB</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line">	<span class="comment">// 连接到 SQLite 数据库 (test.db)</span></span><br><span class="line">	DB, err = gorm.Open(sqlite.Open(<span class="string">&quot;test.db&quot;</span>), &amp;gorm.Config&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;failed to connect database: &quot;</span> + err.Error())</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 自动迁移模式，根据 User 结构体创建或更新数据库表</span></span><br><span class="line">	err = DB.AutoMigrate(&amp;User&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(<span class="string">&quot;failed to auto migrate: &quot;</span> + err.Error())</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Database connected and migrated successfully!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 这里可以调用各种操作函数进行演示</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n--- 开始 GORM 操作演示 ---&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 插入操作</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n--- 插入 (Create) ---&quot;</span>)</span><br><span class="line">	user1 := createUser(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;alice@example.com&quot;</span>, <span class="number">30</span>)</span><br><span class="line">	createUser(<span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;bob@example.com&quot;</span>, <span class="number">25</span>)</span><br><span class="line">	createUsersBatch([]User&#123;</span><br><span class="line">		&#123;Name: <span class="string">&quot;Charlie&quot;</span>, Email: <span class="string">&quot;charlie@example.com&quot;</span>, Age: <span class="number">35</span>&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;David&quot;</span>, Email: <span class="string">&quot;david@example.com&quot;</span>, Age: <span class="number">40</span>&#125;,</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 查询操作</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n--- 查询 (Retrieve) ---&quot;</span>)</span><br><span class="line">	findUserByID(user1.ID)</span><br><span class="line">	findUserByEmail(<span class="string">&quot;bob@example.com&quot;</span>)</span><br><span class="line">	findAllUsers()</span><br><span class="line">	findUsersByName(<span class="string">&quot;Alice&quot;</span>)</span><br><span class="line">	findUserWithConditions()</span><br><span class="line">	findPaginatedUsers(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 第一页，每页2条</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 更新操作</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n--- 更新 (Update) ---&quot;</span>)</span><br><span class="line">	updateUserByID(user1.ID, <span class="string">&quot;Alice Smith&quot;</span>, <span class="string">&quot;alice.smith@example.com&quot;</span>)</span><br><span class="line">	updateUserColumnsByEmail(<span class="string">&quot;bob@example.com&quot;</span>, <span class="number">26</span>, <span class="number">100.5</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 删除操作</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n--- 删除 (Delete) ---&quot;</span>)</span><br><span class="line">	deleteUserByID(user1.ID) <span class="comment">// 软删除</span></span><br><span class="line">	<span class="comment">// hardDeleteUserByID(user1.ID) // 硬删除 (如果需要)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 再次查询所有用户，看软删除效果</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;\n--- 再次查询所有用户 (After Delete) ---&quot;</span>)</span><br><span class="line">	findAllUsers()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-插入数据-Create"><a href="#1-插入数据-Create" class="headerlink" title="1. 插入数据 (Create)"></a>1. 插入数据 (Create)</h2><p>使用 <code>DB.Create()</code> 方法将新的记录插入到数据库中。</p>
<h3 id="1-1-插入单条记录"><a href="#1-1-插入单条记录" class="headerlink" title="1.1 插入单条记录"></a>1.1 插入单条记录</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createUser 插入单条用户记录</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createUser</span><span class="params">(name, email <span class="type">string</span>, age <span class="type">uint</span>)</span></span> *User &#123;</span><br><span class="line">	newUser := User&#123;</span><br><span class="line">		Name:  name,</span><br><span class="line">		Email: email,</span><br><span class="line">		Age:   age,</span><br><span class="line">	&#125;</span><br><span class="line">	result := DB.Create(&amp;newUser) <span class="comment">// 传入结构体指针</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error creating user %s: %v\n&quot;</span>, name, result.Error)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Successfully created user: %s (ID: %d), Rows Affected: %d\n&quot;</span>, newUser.Name, newUser.ID, result.RowsAffected)</span><br><span class="line">	<span class="keyword">return</span> &amp;newUser <span class="comment">// GORM 会将新记录的 ID 填充回结构体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user1 := createUser(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;alice@example.com&quot;</span>, <span class="number">30</span>)</span><br><span class="line"><span class="comment">// 此时 user1.ID 会被 GORM 填充为新插入记录的自增 ID</span></span><br></pre></td></tr></table></figure>

<h3 id="1-2-批量插入记录"><a href="#1-2-批量插入记录" class="headerlink" title="1.2 批量插入记录"></a>1.2 批量插入记录</h3><p>传递一个结构体切片给 <code>DB.Create()</code> 即可实现批量插入。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createUsersBatch 批量插入用户记录</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createUsersBatch</span><span class="params">(users []User)</span></span> &#123;</span><br><span class="line">	result := DB.Create(&amp;users) <span class="comment">// 传入结构体切片指针</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error creating users batch: %v\n&quot;</span>, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Successfully created %d users in batch.\n&quot;</span>, result.RowsAffected)</span><br><span class="line">	<span class="keyword">for</span> _, user := <span class="keyword">range</span> users &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;  - %s (ID: %d)\n&quot;</span>, user.Name, user.ID)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">createUsersBatch([]User&#123;</span><br><span class="line">	&#123;Name: <span class="string">&quot;Charlie&quot;</span>, Email: <span class="string">&quot;charlie@example.com&quot;</span>, Age: <span class="number">35</span>&#125;,</span><br><span class="line">	&#123;Name: <span class="string">&quot;David&quot;</span>, Email: <span class="string">&quot;david@example.com&quot;</span>, Age: <span class="number">40</span>&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="2-查询数据-Retrieve"><a href="#2-查询数据-Retrieve" class="headerlink" title="2. 查询数据 (Retrieve)"></a>2. 查询数据 (Retrieve)</h2><p>GORM 提供了多种查询方法，可以灵活地检索数据。查询结果会赋值给 Go 语言的变量。</p>
<h3 id="2-1-根据主键查询-First-Find"><a href="#2-1-根据主键查询-First-Find" class="headerlink" title="2.1 根据主键查询 (First &#x2F; Find)"></a>2.1 根据主键查询 (First &#x2F; Find)</h3><ul>
<li><code>First(&amp;dest, primaryKey)</code>: 查找主键匹配的第一个记录。如果没有找到记录，<code>result.Error</code> 会是 <code>gorm.ErrRecordNotFound</code>。</li>
<li><code>Find(&amp;dest, primaryKey)</code>: 查找主键匹配的所有记录。如果找到多个，只会赋值给切片。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// findUserByID 根据 ID 查询用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findUserByID</span><span class="params">(id <span class="type">uint</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// First 会根据主键查找，如果找不到会返回 gorm.ErrRecordNotFound</span></span><br><span class="line">	result := DB.First(&amp;user, id) <span class="comment">// 传入结构体指针和主键值</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> result.Error == gorm.ErrRecordNotFound &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;User with ID %d not found.\n&quot;</span>, id)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;Error finding user by ID %d: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found User by ID %d: Name=%s, Email=%s, Age=%d\n&quot;</span>, user.ID, user.Name, user.Email, user.Age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findUserByID(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-2-根据条件查询-Where"><a href="#2-2-根据条件查询-Where" class="headerlink" title="2.2 根据条件查询 (Where)"></a>2.2 根据条件查询 (Where)</h3><p>使用 <code>Where()</code> 方法添加查询条件。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// findUserByEmail 根据邮箱查询用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findUserByEmail</span><span class="params">(email <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// Where 方法用于构建查询条件</span></span><br><span class="line">	result := DB.Where(<span class="string">&quot;email = ?&quot;</span>, email).First(&amp;user) <span class="comment">// 使用占位符防止 SQL 注入</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> result.Error == gorm.ErrRecordNotFound &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;User with email %s not found.\n&quot;</span>, email)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;Error finding user by email %s: %v\n&quot;</span>, email, result.Error)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found User by Email %s: Name=%s, Age=%d\n&quot;</span>, user.Email, user.Name, user.Age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// findUsersByName 根据姓名模糊查询所有匹配的用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findUsersByName</span><span class="params">(name <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> users []User <span class="comment">// 声明一个结构体切片来存储多条记录</span></span><br><span class="line">	<span class="comment">// 使用 LIKE 进行模糊匹配</span></span><br><span class="line">	result := DB.Where(<span class="string">&quot;name LIKE ?&quot;</span>, <span class="string">&quot;%&quot;</span>+name+<span class="string">&quot;%&quot;</span>).Find(&amp;users)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error finding users by name %s: %v\n&quot;</span>, name, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(users) == <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;No users found with name containing &#x27;%s&#x27;.\n&quot;</span>, name)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found %d users with name containing &#x27;%s&#x27;:\n&quot;</span>, <span class="built_in">len</span>(users), name)</span><br><span class="line">	<span class="keyword">for</span> _, user := <span class="keyword">range</span> users &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;  - ID: %d, Name: %s, Email: %s\n&quot;</span>, user.ID, user.Name, user.Email)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// findUserWithConditions 复杂条件查询</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findUserWithConditions</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// 链式调用多个 Where 条件</span></span><br><span class="line">	result := DB.Where(<span class="string">&quot;age &gt; ?&quot;</span>, <span class="number">20</span>).Where(<span class="string">&quot;name LIKE ?&quot;</span>, <span class="string">&quot;%lice%&quot;</span>).First(&amp;user)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> result.Error == gorm.ErrRecordNotFound &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;No user found with age &gt; 20 and name like &#x27;%lice%&#x27;.&quot;</span>)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;Error finding user with conditions: %v\n&quot;</span>, result.Error)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found User with conditions: ID=%d, Name=%s, Age=%d\n&quot;</span>, user.ID, user.Name, user.Age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">findUserByEmail(<span class="string">&quot;bob@example.com&quot;</span>)</span><br><span class="line">findUsersByName(<span class="string">&quot;li&quot;</span>) <span class="comment">// 查找名字中包含 &quot;li&quot; 的用户</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-查询所有记录-Find"><a href="#2-3-查询所有记录-Find" class="headerlink" title="2.3 查询所有记录 (Find)"></a>2.3 查询所有记录 (Find)</h3><p>不带 <code>Where()</code> 条件的 <code>Find()</code> 方法会查询表中的所有记录。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// findAllUsers 查询所有用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findAllUsers</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> users []User <span class="comment">// 声明一个结构体切片</span></span><br><span class="line">	result := DB.Find(&amp;users)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error finding all users: %v\n&quot;</span>, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(users) == <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;No users found in the database.&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found %d users:\n&quot;</span>, <span class="built_in">len</span>(users))</span><br><span class="line">	<span class="keyword">for</span> _, user := <span class="keyword">range</span> users &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;  - ID: %d, Name: %s, Email: %s, Age: %d, CreatedAt: %s\n&quot;</span>,</span><br><span class="line">			user.ID, user.Name, user.Email, user.Age, user.CreatedAt.Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findAllUsers()</span><br></pre></td></tr></table></figure>

<h3 id="2-4-排序、限制和偏移-Order-Limit-Offset"><a href="#2-4-排序、限制和偏移-Order-Limit-Offset" class="headerlink" title="2.4 排序、限制和偏移 (Order, Limit, Offset)"></a>2.4 排序、限制和偏移 (Order, Limit, Offset)</h3><p>用于分页和排序查询结果。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// findPaginatedUsers 分页查询用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findPaginatedUsers</span><span class="params">(page, pageSize <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> users []User</span><br><span class="line">	offset := (page - <span class="number">1</span>) * pageSize <span class="comment">// 计算偏移量</span></span><br><span class="line"></span><br><span class="line">	result := DB.Offset(offset).Limit(pageSize).Order(<span class="string">&quot;created_at desc&quot;</span>).Find(&amp;users)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error finding paginated users (Page %d, Size %d): %v\n&quot;</span>, page, pageSize, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(users) == <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;No users found on page %d (size %d).\n&quot;</span>, page, pageSize)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found %d users on Page %d (Size %d):\n&quot;</span>, <span class="built_in">len</span>(users), page, pageSize)</span><br><span class="line">	<span class="keyword">for</span> _, user := <span class="keyword">range</span> users &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;  - ID: %d, Name: %s, CreatedAt: %s\n&quot;</span>, user.ID, user.Name, user.CreatedAt.Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findPaginatedUsers(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 查询第一页，每页2条</span></span><br></pre></td></tr></table></figure>

<h2 id="3-更新数据-Update"><a href="#3-更新数据-Update" class="headerlink" title="3. 更新数据 (Update)"></a>3. 更新数据 (Update)</h2><p>GORM 提供了多种更新数据的方法。</p>
<h3 id="3-1-更新单个字段-Update"><a href="#3-1-更新单个字段-Update" class="headerlink" title="3.1 更新单个字段 (Update)"></a>3.1 更新单个字段 (Update)</h3><p><code>Update()</code> 方法用于更新模型的单个字段。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// updateUserByID 根据 ID 更新用户姓名和邮箱</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateUserByID</span><span class="params">(id <span class="type">uint</span>, newName, newEmail <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// 首先找到记录</span></span><br><span class="line">	result := DB.First(&amp;user, id)</span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error finding user ID %d for update: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 更新单个字段</span></span><br><span class="line">	<span class="comment">// DB.Model(&amp;user).Update(&quot;name&quot;, newName) // 更新单个字段</span></span><br><span class="line">	<span class="comment">// DB.Model(&amp;user).Update(&quot;email&quot;, newEmail)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 更新多个字段 (使用 map 或结构体)</span></span><br><span class="line">	result = DB.Model(&amp;user).Updates(User&#123;Name: newName, Email: newEmail&#125;) <span class="comment">// 使用结构体更新</span></span><br><span class="line">	<span class="comment">// 或者</span></span><br><span class="line">	<span class="comment">// result = DB.Model(&amp;user).Updates(map[string]interface&#123;&#125;&#123;&quot;name&quot;: newName, &quot;email&quot;: newEmail&#125;) // 使用 map 更新</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error updating user ID %d: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Successfully updated user ID %d to Name: %s, Email: %s, Rows Affected: %d\n&quot;</span>, id, newName, newEmail, result.RowsAffected)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">updateUserByID(<span class="number">1</span>, <span class="string">&quot;Alice Smith&quot;</span>, <span class="string">&quot;alice.smith@example.com&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-2-更新多个字段-Updates"><a href="#3-2-更新多个字段-Updates" class="headerlink" title="3.2 更新多个字段 (Updates)"></a>3.2 更新多个字段 (Updates)</h3><p><code>Updates()</code> 方法用于更新模型的多个字段。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// updateUserColumnsByEmail 根据邮箱更新用户年龄和余额</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateUserColumnsByEmail</span><span class="params">(email <span class="type">string</span>, newAge <span class="type">uint</span>, newBalance <span class="type">float64</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">// 使用 Where 找到记录，然后用 Updates 更新</span></span><br><span class="line">	result := DB.Model(&amp;User&#123;&#125;).Where(<span class="string">&quot;email = ?&quot;</span>, email).Updates(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">		<span class="string">&quot;age&quot;</span>:     newAge,</span><br><span class="line">		<span class="string">&quot;balance&quot;</span>: newBalance,</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error updating user by email %s: %v\n&quot;</span>, email, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> result.RowsAffected == <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;No user found with email %s to update.\n&quot;</span>, email)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Successfully updated user with email %s, Rows Affected: %d\n&quot;</span>, email, result.RowsAffected)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">updateUserColumnsByEmail(<span class="string">&quot;bob@example.com&quot;</span>, <span class="number">26</span>, <span class="number">100.5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-3-计数器更新-Inc-Dec"><a href="#3-3-计数器更新-Inc-Dec" class="headerlink" title="3.3 计数器更新 (Inc &#x2F; Dec)"></a>3.3 计数器更新 (Inc &#x2F; Dec)</h3><p>用于原子性地增加或减少字段值。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// incrementUserAge 增加用户年龄</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">incrementUserAge</span><span class="params">(id <span class="type">uint</span>, delta <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	result := DB.First(&amp;user, id)</span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error finding user ID %d for age increment: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result = DB.Model(&amp;user).Update(<span class="string">&quot;age&quot;</span>, gorm.Expr(<span class="string">&quot;age + ?&quot;</span>, delta))</span><br><span class="line">	<span class="comment">// 或者使用 Inc/Dec 方法 (GORM v1.20.0+):</span></span><br><span class="line">	<span class="comment">// result = DB.Model(&amp;user).Inc(&quot;age&quot;, delta)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error incrementing age for user ID %d: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Successfully incremented age for user ID %d, Rows Affected: %d\n&quot;</span>, id, result.RowsAffected)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-删除数据-Delete"><a href="#4-删除数据-Delete" class="headerlink" title="4. 删除数据 (Delete)"></a>4. 删除数据 (Delete)</h2><p>GORM 支持软删除和硬删除。</p>
<h3 id="4-1-软删除-Soft-Delete"><a href="#4-1-软删除-Soft-Delete" class="headerlink" title="4.1 软删除 (Soft Delete)"></a>4.1 软删除 (Soft Delete)</h3><p>如果你的模型嵌入了 <code>gorm.Model</code>（或包含 <code>DeletedAt gorm.DeletedAt</code> 字段），GORM 默认会进行软删除。它不会真正删除记录，而是将 <code>DeletedAt</code> 字段设置为当前时间。</p>
<p>软删除的记录在常规查询中不会被检索到，除非使用 <code>Unscoped()</code> 方法。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// deleteUserByID 软删除用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">deleteUserByID</span><span class="params">(id <span class="type">uint</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// 使用 Delete 方法进行软删除</span></span><br><span class="line">	result := DB.Delete(&amp;user, id) <span class="comment">// 传入结构体指针和主键值</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error soft deleting user ID %d: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Successfully soft deleted user ID %d, Rows Affected: %d\n&quot;</span>, id, result.RowsAffected)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// findDeletedUserByID 查找被软删除的用户 (需要 Unscoped)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">findDeletedUserByID</span><span class="params">(id <span class="type">uint</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// 使用 Unscoped() 方法可以查询被软删除的记录</span></span><br><span class="line">	result := DB.Unscoped().First(&amp;user, id)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> result.Error == gorm.ErrRecordNotFound &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;User with ID %d (including deleted) not found.\n&quot;</span>, id)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;Error finding deleted user by ID %d: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Found Deleted User by ID %d: Name=%s, DeletedAt=%s\n&quot;</span>, user.ID, user.Name, user.DeletedAt.Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">deleteUserByID(<span class="number">1</span>) <span class="comment">// 软删除 ID 为 1 的用户</span></span><br><span class="line">findUserByID(<span class="number">1</span>)   <span class="comment">// 此时应该找不到 ID 为 1 的用户</span></span><br><span class="line">findDeletedUserByID(<span class="number">1</span>) <span class="comment">// 可以找到被软删除的用户</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-硬删除-Permanent-Delete"><a href="#4-2-硬删除-Permanent-Delete" class="headerlink" title="4.2 硬删除 (Permanent Delete)"></a>4.2 硬删除 (Permanent Delete)</h3><p>如果你想彻底从数据库中删除记录，可以使用 <code>Unscoped().Delete()</code>。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hardDeleteUserByID 硬删除用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hardDeleteUserByID</span><span class="params">(id <span class="type">uint</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> user User</span><br><span class="line">	<span class="comment">// 使用 Unscoped().Delete() 进行硬删除</span></span><br><span class="line">	result := DB.Unscoped().Delete(&amp;user, id)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> result.Error != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;Error hard deleting user ID %d: %v\n&quot;</span>, id, result.Error)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Successfully hard deleted user ID %d, Rows Affected: %d\n&quot;</span>, id, result.RowsAffected)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>使用示例：</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hardDeleteUserByID(1) // 硬删除 ID 为 1 的用户</span></span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文档涵盖了 GORM 中最常用的数据库操作方法。GORM 还有许多高级功能，例如：</p>
<ul>
<li><strong>关联 (Associations)</strong>：一对一、一对多、多对多关系。</li>
<li><strong>事务 (Transactions)</strong>：确保一系列数据库操作的原子性。</li>
<li><strong>预加载 (Preloading)</strong>：一次性加载关联数据以避免 N+1 查询问题。</li>
<li><strong>Hook (钩子)</strong>：在创建、更新、删除等操作前后执行自定义逻辑。</li>
<li><strong>原生 SQL (Raw SQL)</strong>：当 ORM 无法满足需求时，直接执行 SQL 语句。</li>
</ul>
<p>查阅 <a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/index.html">GORM 官方文档</a> 以获取更多详细信息和高级用法。 </p>
<hr>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/03/27/22-00-44-kid1412.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/03/27/22-00-44-kid1412.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">King Leonardo</div><div class="post-copyright__author_desc">个人博客</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/06/03/backend-gorm/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/06/03/backend-gorm/')">GORM 数据库操作</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://imgs.161517.xyz/2025/06/02/wechat-pay-qr.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/06/02/wechat-pay-qr.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://imgs.161517.xyz/2025/06/02/alipay-qr.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/06/02/alipay-qr.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/06/03/backend-gorm/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=GORM 数据库操作&amp;url=http://example.com/2025/06/03/backend-gorm/&amp;pic=https://imgs.161517.xyz/2025/05/10/1009.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">LeoBlog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Backend/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Backend<span class="tagsPageCount">5</span></a><a class="post-meta__box__tags" href="/tags/GORM/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>GORM<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E9%A1%B9%E7%9B%AE/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>项目<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>数据库<span class="tagsPageCount">2</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://imgs.161517.xyz/2025/05/10/1010.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/06/03/backend-gin/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1001.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Gin Web Framework 使用</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/03/viper/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1004.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Viper 极简配置读取</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/06/02/backend-go/" title="Go 项目工程化指南"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1008.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-02</div><div class="title">Go 项目工程化指南</div></div></a></div><div><a href="/2025/06/03/go-redis/" title="Go-Redis"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1003.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-03</div><div class="title">Go-Redis</div></div></a></div><div><a href="/2025/06/03/backend-gin/" title="Gin Web Framework 使用"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1001.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-03</div><div class="title">Gin Web Framework 使用</div></div></a></div><div><a href="/2025/06/28/go-tags/" title="Go-Tags"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1010.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-28</div><div class="title">Go-Tags</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/03/27/22-00-44-kid1412.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">这是我的个人博客，用于交流、学习技术，欢迎访问！</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">King Leonardo</h1><div class="author-info__desc">个人博客</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/kingleonardo999" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://imgs.161517.xyz/2025/03/27/19-05-30-front.jpg) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://imgs.161517.xyz/2025/03/27/19-00-44-back.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GORM-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E9%80%9F%E6%9F%A5%E6%89%8B%E5%86%8C"><span class="toc-number">1.</span> <span class="toc-text">GORM 数据库操作速查手册</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E4%B8%8E%E6%A8%A1%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.1.</span> <span class="toc-text">数据库连接与模型定义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE-Create"><span class="toc-number">1.2.</span> <span class="toc-text">1. 插入数据 (Create)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%8F%92%E5%85%A5%E5%8D%95%E6%9D%A1%E8%AE%B0%E5%BD%95"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1 插入单条记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%E8%AE%B0%E5%BD%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2 批量插入记录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE-Retrieve"><span class="toc-number">1.3.</span> <span class="toc-text">2. 查询数据 (Retrieve)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%A0%B9%E6%8D%AE%E4%B8%BB%E9%94%AE%E6%9F%A5%E8%AF%A2-First-Find"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 根据主键查询 (First &#x2F; Find)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%A0%B9%E6%8D%AE%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-Where"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 根据条件查询 (Where)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E8%AE%B0%E5%BD%95-Find"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3 查询所有记录 (Find)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%8E%92%E5%BA%8F%E3%80%81%E9%99%90%E5%88%B6%E5%92%8C%E5%81%8F%E7%A7%BB-Order-Limit-Offset"><span class="toc-number">1.3.4.</span> <span class="toc-text">2.4 排序、限制和偏移 (Order, Limit, Offset)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE-Update"><span class="toc-number">1.4.</span> <span class="toc-text">3. 更新数据 (Update)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%9B%B4%E6%96%B0%E5%8D%95%E4%B8%AA%E5%AD%97%E6%AE%B5-Update"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1 更新单个字段 (Update)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%9B%B4%E6%96%B0%E5%A4%9A%E4%B8%AA%E5%AD%97%E6%AE%B5-Updates"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2 更新多个字段 (Updates)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E8%AE%A1%E6%95%B0%E5%99%A8%E6%9B%B4%E6%96%B0-Inc-Dec"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.3 计数器更新 (Inc &#x2F; Dec)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE-Delete"><span class="toc-number">1.5.</span> <span class="toc-text">4. 删除数据 (Delete)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E8%BD%AF%E5%88%A0%E9%99%A4-Soft-Delete"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1 软删除 (Soft Delete)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%A1%AC%E5%88%A0%E9%99%A4-Permanent-Delete"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.2 硬删除 (Permanent Delete)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/28/go-tags/" title="Go-Tags"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1010.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go-Tags"/></a><div class="content"><a class="title" href="/2025/06/28/go-tags/" title="Go-Tags">Go-Tags</a><time datetime="2025-06-28T03:49:46.968Z" title="发表于 2025-06-28 11:49:46">2025-06-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/go-redis/" title="Go-Redis"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1003.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go-Redis"/></a><div class="content"><a class="title" href="/2025/06/03/go-redis/" title="Go-Redis">Go-Redis</a><time datetime="2025-06-03T02:27:15.838Z" title="发表于 2025-06-03 10:27:15">2025-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/viper/" title="Viper 极简配置读取"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1004.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Viper 极简配置读取"/></a><div class="content"><a class="title" href="/2025/06/03/viper/" title="Viper 极简配置读取">Viper 极简配置读取</a><time datetime="2025-06-03T02:26:53.696Z" title="发表于 2025-06-03 10:26:53">2025-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/backend-gorm/" title="GORM 数据库操作"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1009.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GORM 数据库操作"/></a><div class="content"><a class="title" href="/2025/06/03/backend-gorm/" title="GORM 数据库操作">GORM 数据库操作</a><time datetime="2025-06-03T02:26:36.843Z" title="发表于 2025-06-03 10:26:36">2025-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/backend-gin/" title="Gin Web Framework 使用"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://imgs.161517.xyz/2025/05/10/1001.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gin Web Framework 使用"/></a><div class="content"><a class="title" href="/2025/06/03/backend-gin/" title="Gin Web Framework 使用">Gin Web Framework 使用</a><time datetime="2025-06-03T02:24:54.100Z" title="发表于 2025-06-03 10:24:54">2025-06-03</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="King Leonardo" target="_blank">King Leonardo</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Backend/" style="font-size: 0.88rem;">Backend<sup>5</sup></a><a href="/tags/GORM/" style="font-size: 0.88rem;">GORM<sup>1</sup></a><a href="/tags/Gin/" style="font-size: 0.88rem;">Gin<sup>1</sup></a><a href="/tags/Go/" style="font-size: 0.88rem;">Go<sup>4</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>1</sup></a><a href="/tags/Redis/" style="font-size: 0.88rem;">Redis<sup>1</sup></a><a href="/tags/Viper/" style="font-size: 0.88rem;">Viper<sup>1</sup></a><a href="/tags/Web-Framework/" style="font-size: 0.88rem;">Web Framework<sup>1</sup></a><a href="/tags/frontend/" style="font-size: 0.88rem;">frontend<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 0.88rem;">博客搭建<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem;">数据库<sup>2</sup></a><a href="/tags/%E7%BC%93%E5%AD%98/" style="font-size: 0.88rem;">缓存<sup>1</sup></a><a href="/tags/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96/" style="font-size: 0.88rem;">配置读取<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 0.88rem;">项目<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>